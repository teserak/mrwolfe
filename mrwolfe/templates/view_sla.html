{% extends "base.html" %}

{% block tools %}
<a class="btn btn-success" 
   href="{% url 'create_issue' %}?sla={{ sla.pk }}"><i class="icon-plus"></i> New issue</a>
{% endblock %}

{% block content %}

<h2>{{ object }}
  <div class="btn-group controls">
    <a class="btn btn-mini"
       href="{% url 'edit_sla' sla.pk %}"><i class="icon-pencil"></i></a>  
    <a class="btn btn-mini btn-danger"
       href="{% url 'delete_sla' sla.pk %}"><i class="icon-remove"></i></a>
  </div>
</h2>

<table class="table well">
  <thead>
    <th># Issues</th>
    <th># Issues late</th>
    <th>% Issues late</th>
  </thead>
  <tbody>
    <td>{{ view.nr_of_issues }}</td>
    <td>{{ view.nr_of_issues_late }}</td>
    <td>{{ view.perc_of_issues_late }}%</td>
  </tbody>
</table>

<div class="viewlet well">
  <h2>Contacts
  </h2>
  
  {% if not view.list_contacts %}
  <div class="alert warning">No contacts defined yet!</div>
  {% endif %}
  
  <ul id="contacts">
    {% for contact in view.list_contacts %}
    {% include "snippets/contact.html" with object=contact %}
    {% endfor %}
  </ul>
</div>

<div class="viewlet well">
  <h2>Services 
    <a class="add-inline btn btn-success btn-mini"
       target="#services"
       href="{% url 'create_service_json' sla.pk %}"
       ><i class="icon-plus"></i></a>
  </h2>
  
  {% if not view.list_services %}
  <div class="alert warning">No services defined yet!</div>
  {% endif %}
  
  <ul id="services">
    {% for service in view.list_services %}
    {% include "snippets/service.html" with object=service %}
    {% endfor %}
  </ul>
</div>

<div class="viewlet well">
  <h2>Rules 
    <a class="add-inline btn btn-success btn-mini"
       target="#rules"
       href="{% url 'create_rule_json' sla.pk %}"
       ><i class="icon-plus"></i></a>
  </h2>

  <p class="text-info">
    Add matching rules for incoming mail. If a rule matches, this SLA
    will be the one!
  </p>
  
  {% if not view.list_rules %}
  <div class="alert warning">No rules defined yet!</div>
  {% endif %}

  <ul id="rules">
    {% for rule in view.list_rules %}
    {% include "snippets/rule.html" with object=rule %}
    {% endfor %}
  </ul>
</div>

{% endblock %}
